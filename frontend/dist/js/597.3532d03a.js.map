{"version":3,"file":"js/597.3532d03a.js","mappings":"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","sources":["webpack://frontend/./src/views/admin/ArticleForm.vue","webpack://frontend/./src/views/admin/ArticleForm.vue?1388"],"sourcesContent":["<template>\r\n  <div>\r\n    <h1>{{ isEditing ? 'Edit Artikel' : 'Tambah Artikel Baru' }}</h1>\r\n    <form @submit.prevent=\"handleSubmit\" class=\"article-form\">\r\n      <div class=\"form-group\">\r\n        <label for=\"title\">Judul Artikel</label>\r\n        <input type=\"text\" id=\"title\" v-model=\"article.title\" required>\r\n      </div>\r\n\r\n      <!-- ### BAGIAN BARU DITAMBAHKAN DI SINI ### -->\r\n      <div class=\"form-group\">\r\n        <label for=\"author\">Penulis</label>\r\n        <!-- Input ini dinonaktifkan karena nama penulis diambil otomatis dari user yang login -->\r\n        <input type=\"text\" id=\"author\" :value=\"authorName\" readonly disabled>\r\n      </div>\r\n\r\n      <!-- Input untuk Upload Gambar -->\r\n      <div class=\"form-group\">\r\n        <label for=\"imageUpload\">Upload Gambar Sampul</label>\r\n        <input type=\"file\" id=\"imageUpload\" @change=\"handleFileChange\" accept=\"image/png, image/jpeg, image/jpg\">\r\n        \r\n        <!-- Area Preview Gambar -->\r\n        <div v-if=\"imagePreview\" class=\"image-preview\">\r\n          <p>Preview Gambar Baru:</p>\r\n          <img :src=\"imagePreview\" alt=\"Preview Gambar\">\r\n        </div>\r\n        <!-- Tampilkan gambar yang sudah ada saat mode edit -->\r\n        <div v-else-if=\"isEditing && article.imageUrl\" class=\"image-preview\">\r\n            <p>Gambar Saat Ini:</p>\r\n            <img :src=\"`http://localhost:5000${article.imageUrl}`\" alt=\"Gambar Artikel\">\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"form-group\">\r\n        <label for=\"category\">Kategori</label>\r\n        <select id=\"category\" v-model=\"article.category_id\" required>\r\n          <option disabled value=\"\">Pilih kategori...</option>\r\n          <option v-for=\"cat in categories\" :key=\"cat.id\" :value=\"cat.id\">\r\n            {{ cat.name }}\r\n          </option>\r\n        </select>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"content\">Konten</label>\r\n        <textarea id=\"content\" v-model=\"article.content\" rows=\"15\" required></textarea>\r\n      </div>\r\n      <AppButton type=\"submit\" variant=\"primary\" :disabled=\"isUploading\">\r\n        {{ isUploading ? 'Menyimpan...' : (isEditing ? 'Simpan Perubahan' : 'Publikasikan Artikel') }}\r\n      </AppButton>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { useStore } from 'vuex';\r\nimport ApiService from '@/services/ApiService';\r\nimport AppButton from '@/components/common/AppButton.vue';\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst store = useStore();\r\n\r\nconst article = ref({\r\n  title: '',\r\n  content: '',\r\n  imageUrl: '',\r\n  category_id: '',\r\n});\r\nconst categories = ref([]);\r\nconst isEditing = computed(() => !!route.params.id);\r\n\r\n// ### LOGIKA BARU UNTUK NAMA PENULIS ###\r\nconst authorName = computed(() => store.getters['auth/currentUser']?.name || 'Admin');\r\n\r\n// State baru untuk upload gambar\r\nconst selectedFile = ref(null);\r\nconst imagePreview = ref('');\r\nconst isUploading = ref(false);\r\n\r\n// Fungsi untuk menangani pemilihan file\r\nconst handleFileChange = (event) => {\r\n  const file = event.target.files[0];\r\n  if (file) {\r\n    selectedFile.value = file;\r\n    // Buat URL sementara untuk ditampilkan sebagai preview\r\n    imagePreview.value = URL.createObjectURL(file);\r\n  }\r\n};\r\n\r\nonMounted(async () => {\r\n  // Ambil daftar kategori untuk dropdown\r\n  try {\r\n    const catResponse = await ApiService.getCategories();\r\n    categories.value = catResponse.data;\r\n  } catch (error) {\r\n    console.error(\"Gagal mengambil kategori:\", error);\r\n  }\r\n\r\n  // Jika ini mode edit, ambil data artikel yang ada\r\n  if (isEditing.value) {\r\n    try {\r\n      const artResponse = await ApiService.getArticle(route.params.id);\r\n      article.value = artResponse.data;\r\n    } catch (error) {\r\n      console.error(\"Gagal mengambil artikel untuk diedit:\", error);\r\n    }\r\n  }\r\n});\r\n\r\n// Fungsi yang dijalankan saat form disubmit\r\nconst handleSubmit = async () => {\r\n  isUploading.value = true;\r\n  let imageUrl = article.value.imageUrl; // Simpan URL gambar yang sudah ada (untuk mode edit)\r\n\r\n  // 1. Jika ada file baru yang dipilih, unggah dulu\r\n  if (selectedFile.value) {\r\n    const formData = new FormData();\r\n    formData.append('image', selectedFile.value);\r\n    try {\r\n      const uploadResponse = await ApiService.uploadImage(formData);\r\n      imageUrl = uploadResponse.data.imagePath; // Dapatkan path gambar baru dari backend\r\n    } catch (error) {\r\n      console.error(\"Gagal mengunggah gambar:\", error);\r\n      alert(\"Gagal mengunggah gambar. Pastikan file adalah gambar (jpg/png).\");\r\n      isUploading.value = false;\r\n      return;\r\n    }\r\n  }\r\n\r\n  // 2. Siapkan payload data artikel\r\n  const author_id = store.getters['auth/currentUser']?.id;\r\n  if (!author_id) {\r\n    alert(\"Sesi admin tidak valid. Silakan login ulang.\");\r\n    isUploading.value = false;\r\n    return;\r\n  }\r\n  const payload = { ...article.value, imageUrl, author_id };\r\n\r\n  // 3. Kirim data artikel ke backend (create atau update)\r\n  try {\r\n    if (isEditing.value) {\r\n      await ApiService.updateArticle(route.params.id, payload);\r\n    } else {\r\n      await ApiService.createArticle(payload);\r\n    }\r\n    // Arahkan kembali ke halaman manajemen artikel setelah berhasil\r\n    router.push('/admin/articles');\r\n  } catch (error) {\r\n    console.error(\"Gagal menyimpan artikel:\", error);\r\n    alert(\"Terjadi kesalahan saat menyimpan artikel.\");\r\n  } finally {\r\n    isUploading.value = false;\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.article-form {\r\n  background: white;\r\n  padding: 25px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.05);\r\n}\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 8px;\r\n  font-weight: 600;\r\n}\r\n.form-group input,\r\n.form-group select,\r\n.form-group textarea {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border: 1px solid #ccc;\r\n  border-radius: 4px;\r\n  font-size: 1rem;\r\n}\r\n/* Style untuk input yang dinonaktifkan */\r\n.form-group input:disabled {\r\n    background-color: #f0f0f0;\r\n    cursor: not-allowed;\r\n}\r\ntextarea {\r\n  min-height: 250px;\r\n  resize: vertical;\r\n}\r\n.image-preview {\r\n  margin-top: 15px;\r\n  border: 1px dashed #ccc;\r\n  padding: 10px;\r\n  border-radius: 8px;\r\n}\r\n.image-preview img {\r\n  max-width: 250px;\r\n  height: auto;\r\n  border-radius: 4px;\r\n  display: block;\r\n}\r\n</style>\r\n","import script from \"./ArticleForm.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ArticleForm.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ArticleForm.vue?vue&type=style&index=0&id=66731367&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-66731367\"]])\n\nexport default __exports__"],"names":["route","useRoute","router","useRouter","store","useStore","article","ref","title","content","imageUrl","category_id","categories","isEditing","computed","params","id","authorName","getters","name","selectedFile","imagePreview","isUploading","handleFileChange","event","file","target","files","value","URL","createObjectURL","onMounted","async","catResponse","ApiService","getCategories","data","error","console","artResponse","getArticle","handleSubmit","formData","FormData","append","uploadResponse","uploadImage","imagePath","alert","author_id","payload","updateArticle","createArticle","push","_createElementBlock","_createElementVNode","_toDisplayString","onSubmit","_withModifiers","class","_hoisted_1","for","type","$event","required","_hoisted_2","readonly","disabled","_hoisted_4","onChange","accept","_hoisted_5","src","alt","_hoisted_7","_hoisted_9","_Fragment","_renderList","cat","key","_hoisted_10","_hoisted_11","rows","_createVNode","AppButton","variant","__exports__"],"sourceRoot":""}