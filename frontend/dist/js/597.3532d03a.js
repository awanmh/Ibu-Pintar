"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[597],{597:(a,e,l)=>{l.r(e),l.d(e,{default:()=>_});var t=l(641),r=l(33),i=l(751),u=l(953),n=l(220),o=l(278),d=l(317),s=l(90);const c={class:"form-group"},m={class:"form-group"},g=["value"],v={class:"form-group"},p={key:0,class:"image-preview"},k=["src"],b={key:1,class:"image-preview"},f=["src"],h={class:"form-group"},y=["value"],L={class:"form-group"},A={__name:"ArticleForm",setup(a){const e=(0,n.lq)(),l=(0,n.rd)(),A=(0,o.Pj)(),U=(0,u.KR)({title:"",content:"",imageUrl:"",category_id:""}),w=(0,u.KR)([]),_=(0,t.EW)((()=>!!e.params.id)),G=(0,t.EW)((()=>A.getters["auth/currentUser"]?.name||"Admin")),C=(0,u.KR)(null),P=(0,u.KR)(""),E=(0,u.KR)(!1),K=a=>{const e=a.target.files[0];e&&(C.value=e,P.value=URL.createObjectURL(e))};(0,t.sV)((async()=>{try{const a=await d.A.getCategories();w.value=a.data}catch(a){console.error("Gagal mengambil kategori:",a)}if(_.value)try{const a=await d.A.getArticle(e.params.id);U.value=a.data}catch(a){console.error("Gagal mengambil artikel untuk diedit:",a)}}));const R=async()=>{E.value=!0;let a=U.value.imageUrl;if(C.value){const e=new FormData;e.append("image",C.value);try{const l=await d.A.uploadImage(e);a=l.data.imagePath}catch(i){return console.error("Gagal mengunggah gambar:",i),alert("Gagal mengunggah gambar. Pastikan file adalah gambar (jpg/png)."),void(E.value=!1)}}const t=A.getters["auth/currentUser"]?.id;if(!t)return alert("Sesi admin tidak valid. Silakan login ulang."),void(E.value=!1);const r={...U.value,imageUrl:a,author_id:t};try{_.value?await d.A.updateArticle(e.params.id,r):await d.A.createArticle(r),l.push("/admin/articles")}catch(i){console.error("Gagal menyimpan artikel:",i),alert("Terjadi kesalahan saat menyimpan artikel.")}finally{E.value=!1}};return(a,e)=>((0,t.uX)(),(0,t.CE)("div",null,[(0,t.Lk)("h1",null,(0,r.v_)(_.value?"Edit Artikel":"Tambah Artikel Baru"),1),(0,t.Lk)("form",{onSubmit:(0,i.D$)(R,["prevent"]),class:"article-form"},[(0,t.Lk)("div",c,[e[3]||(e[3]=(0,t.Lk)("label",{for:"title"},"Judul Artikel",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=a=>U.value.title=a),required:""},null,512),[[i.Jo,U.value.title]])]),(0,t.Lk)("div",m,[e[4]||(e[4]=(0,t.Lk)("label",{for:"author"},"Penulis",-1)),(0,t.Lk)("input",{type:"text",id:"author",value:G.value,readonly:"",disabled:""},null,8,g)]),(0,t.Lk)("div",v,[e[7]||(e[7]=(0,t.Lk)("label",{for:"imageUpload"},"Upload Gambar Sampul",-1)),(0,t.Lk)("input",{type:"file",id:"imageUpload",onChange:K,accept:"image/png, image/jpeg, image/jpg"},null,32),P.value?((0,t.uX)(),(0,t.CE)("div",p,[e[5]||(e[5]=(0,t.Lk)("p",null,"Preview Gambar Baru:",-1)),(0,t.Lk)("img",{src:P.value,alt:"Preview Gambar"},null,8,k)])):_.value&&U.value.imageUrl?((0,t.uX)(),(0,t.CE)("div",b,[e[6]||(e[6]=(0,t.Lk)("p",null,"Gambar Saat Ini:",-1)),(0,t.Lk)("img",{src:`http://localhost:5000${U.value.imageUrl}`,alt:"Gambar Artikel"},null,8,f)])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",h,[e[9]||(e[9]=(0,t.Lk)("label",{for:"category"},"Kategori",-1)),(0,t.bo)((0,t.Lk)("select",{id:"category","onUpdate:modelValue":e[1]||(e[1]=a=>U.value.category_id=a),required:""},[e[8]||(e[8]=(0,t.Lk)("option",{disabled:"",value:""},"Pilih kategori...",-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(w.value,(a=>((0,t.uX)(),(0,t.CE)("option",{key:a.id,value:a.id},(0,r.v_)(a.name),9,y)))),128))],512),[[i.u1,U.value.category_id]])]),(0,t.Lk)("div",L,[e[10]||(e[10]=(0,t.Lk)("label",{for:"content"},"Konten",-1)),(0,t.bo)((0,t.Lk)("textarea",{id:"content","onUpdate:modelValue":e[2]||(e[2]=a=>U.value.content=a),rows:"15",required:""},null,512),[[i.Jo,U.value.content]])]),(0,t.bF)(s.A,{type:"submit",variant:"primary",disabled:E.value},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(E.value?"Menyimpan...":_.value?"Simpan Perubahan":"Publikasikan Artikel"),1)])),_:1},8,["disabled"])],32)]))}};var U=l(262);const w=(0,U.A)(A,[["__scopeId","data-v-66731367"]]),_=w}}]);
//# sourceMappingURL=597.3532d03a.js.map