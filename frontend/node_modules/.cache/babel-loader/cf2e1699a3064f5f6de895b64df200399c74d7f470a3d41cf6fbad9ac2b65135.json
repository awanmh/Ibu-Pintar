{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"login-form\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"error\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"h1\", null, \"Login\", -1 /* HOISTED */)), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"])\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[2] || (_cache[2] = _createElementVNode(\"label\", {\n    for: \"email\"\n  }, \"Email\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.email = $event),\n    id: \"email\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.email]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n    for: \"password\"\n  }, \"Password\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.password = $event),\n    id: \"password\",\n    required: \"\",\n    minlength: \"6\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.password]])]), _cache[4] || (_cache[4] = _createElementVNode(\"button\", {\n    type: \"submit\"\n  }, \"Login\", -1 /* HOISTED */)), $setup.error ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, _toDisplayString($setup.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 32 /* NEED_HYDRATION */), _cache[6] || (_cache[6] = _createElementVNode(\"div\", {\n    class: \"separator\"\n  }, [_createElementVNode(\"span\", null, \"atau\")], -1 /* HOISTED */)), _cache[7] || (_cache[7] = _createElementVNode(\"div\", {\n    id: \"g_id_onload\",\n    \"data-client_id\": \"922035780127-rqc8q5lebeq3l85c720ikc1c6dfv9mbe.apps.googleusercontent.com\",\n    \"data-callback\": \"handleGoogleCredentialResponse\",\n    \"data-auto_prompt\": \"false\"\n  }, null, -1 /* HOISTED */)), _cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n    class: \"g_id_signin\",\n    \"data-type\": \"standard\",\n    \"data-size\": \"large\",\n    \"data-theme\": \"outline\",\n    \"data-text\": \"sign_in_with\",\n    \"data-shape\": \"rectangular\",\n    \"data-logo_alignment\": \"left\"\n  }, null, -1 /* HOISTED */))])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_withModifiers","$setup","handleLogin","_hoisted_3","for","type","email","$event","id","required","_hoisted_4","password","minlength","error","_hoisted_5","_toDisplayString"],"sources":["E:\\ibuPintar\\frontend\\src\\views\\auth\\LoginView.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <div class=\"login-form\">\r\n      <h1>Login</h1>\r\n\r\n      <form @submit.prevent=\"handleLogin\">\r\n        <div class=\"form-group\">\r\n          <label for=\"email\">Email</label>\r\n          <input type=\"email\" v-model=\"email\" id=\"email\" required />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"password\">Password</label>\r\n          <input type=\"password\" v-model=\"password\" id=\"password\" required minlength=\"6\" />\r\n        </div>\r\n\r\n        <button type=\"submit\">Login</button>\r\n        <p v-if=\"error\" class=\"error\">{{ error }}</p>\r\n      </form>\r\n\r\n      <div class=\"separator\">\r\n        <span>atau</span>\r\n      </div>\r\n\r\n      <div id=\"g_id_onload\"\r\n           data-client_id=\"922035780127-rqc8q5lebeq3l85c720ikc1c6dfv9mbe.apps.googleusercontent.com\"\r\n           data-callback=\"handleGoogleCredentialResponse\"\r\n           data-auto_prompt=\"false\">\r\n      </div>\r\n      <div class=\"g_id_signin\"\r\n           data-type=\"standard\"\r\n           data-size=\"large\"\r\n           data-theme=\"outline\"\r\n           data-text=\"sign_in_with\"\r\n           data-shape=\"rectangular\"\r\n           data-logo_alignment=\"left\">\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst email = ref('');\r\nconst password = ref('');\r\nconst error = ref('');\r\n\r\nconst store = useStore();\r\nconst router = useRouter();\r\n\r\nconst handleLogin = async () => {\r\n  try {\r\n    error.value = '';\r\n    await store.dispatch('auth/login', { email: email.value, password: password.value });\r\n\r\n    const role = store.getters['auth/currentUser']?.role;\r\n    if (role === 'admin') {\r\n      router.push('/admin');\r\n    } else if (role === 'visitor') {\r\n      router.push('/');\r\n    } else {\r\n      router.push('/visi');\r\n    }\r\n  } catch (err) {\r\n    error.value = err.response?.data?.message || 'Login gagal.';\r\n  }\r\n};\r\n\r\nconst handleGoogleCredentialResponse = async (response) => {\r\n  try {\r\n    const res = await fetch('http://localhost:5000/api/auth/google-login', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ credential: response.credential }),\r\n    });\r\n\r\n    const data = await res.json();\r\n    if (!res.ok) throw new Error(data.message || 'Login Google gagal.');\r\n\r\n    const userPayload = {\r\n      id: data.id,\r\n      name: data.name,\r\n      email: data.email,\r\n      role: data.role,\r\n    };\r\n\r\n    localStorage.setItem('user', JSON.stringify(userPayload));\r\n    localStorage.setItem('token', data.token);\r\n\r\n    store.commit('auth/AUTH_SUCCESS', { user: userPayload, token: data.token });\r\n\r\n    const role = userPayload.role;\r\n    if (role === 'admin') {\r\n      router.push('/admin');\r\n    } else {\r\n      router.push('/visitor');\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message;\r\n  }\r\n};\r\n\r\nonMounted(() => {\r\n  // Cegah akses ke halaman login jika sudah login\r\n  if (store.getters['auth/isLoggedIn']) {\r\n    const role = store.getters['auth/currentUser']?.role;\r\n    if (role === 'admin') {\r\n      router.push('/admin');\r\n    } else {\r\n      router.push('/visitor');\r\n    }\r\n  }\r\n\r\n  // Daftarkan callback Google\r\n  window.handleGoogleCredentialResponse = handleGoogleCredentialResponse;\r\n\r\n  const script = document.createElement('script');\r\n  script.src = 'https://accounts.google.com/gsi/client';\r\n  script.async = true;\r\n  script.defer = true;\r\n  document.head.appendChild(script);\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100vh;\r\n  background: #f4f4f4;\r\n}\r\n\r\n.login-form {\r\n  background: white;\r\n  padding: 2rem;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 15px rgba(0,0,0,0.1);\r\n  width: 350px;\r\n}\r\n\r\nh1 {\r\n  text-align: center;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: .5rem;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: .5rem;\r\n  border: 1px solid #ccc;\r\n  border-radius: 5px;\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: .75rem;\r\n  background: #007bff;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n}\r\n\r\nbutton:hover {\r\n  background: #0056b3;\r\n}\r\n\r\n.separator {\r\n  text-align: center;\r\n  margin: 1rem 0;\r\n}\r\n\r\n.separator span {\r\n  background: white;\r\n  padding: 0 10px;\r\n  color: #888;\r\n}\r\n\r\n.error {\r\n  color: red;\r\n  margin-top: .5rem;\r\n  text-align: center;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAiB;;EACrBA,KAAK,EAAC;AAAY;;EAIdA,KAAK,EAAC;AAAY;;EAKlBA,KAAK,EAAC;AAAY;;;EAMPA,KAAK,EAAC;;;uBAhB5BC,mBAAA,CAqCM,OArCNC,UAqCM,GApCJC,mBAAA,CAmCM,OAnCNC,UAmCM,G,0BAlCJD,mBAAA,CAAc,YAAV,OAAK,sBAETA,mBAAA,CAaO;IAbAE,QAAM,EAAAC,cAAA,CAAUC,MAAA,CAAAC,WAAW;MAChCL,mBAAA,CAGM,OAHNM,UAGM,G,0BAFJN,mBAAA,CAAgC;IAAzBO,GAAG,EAAC;EAAO,GAAC,OAAK,sB,gBACxBP,mBAAA,CAA0D;IAAnDQ,IAAI,EAAC,OAAO;+DAAUJ,MAAA,CAAAK,KAAK,GAAAC,MAAA;IAAEC,EAAE,EAAC,OAAO;IAACC,QAAQ,EAAR;iDAAlBR,MAAA,CAAAK,KAAK,E,KAGpCT,mBAAA,CAGM,OAHNa,UAGM,G,0BAFJb,mBAAA,CAAsC;IAA/BO,GAAG,EAAC;EAAU,GAAC,UAAQ,sB,gBAC9BP,mBAAA,CAAiF;IAA1EQ,IAAI,EAAC,UAAU;+DAAUJ,MAAA,CAAAU,QAAQ,GAAAJ,MAAA;IAAEC,EAAE,EAAC,UAAU;IAACC,QAAQ,EAAR,EAAQ;IAACG,SAAS,EAAC;iDAA3CX,MAAA,CAAAU,QAAQ,E,+BAG1Cd,mBAAA,CAAoC;IAA5BQ,IAAI,EAAC;EAAQ,GAAC,OAAK,sBAClBJ,MAAA,CAAAY,KAAK,I,cAAdlB,mBAAA,CAA6C,KAA7CmB,UAA6C,EAAAC,gBAAA,CAAZd,MAAA,CAAAY,KAAK,oB,wFAGxChB,mBAAA,CAEM;IAFDH,KAAK,EAAC;EAAW,IACpBG,mBAAA,CAAiB,cAAX,MAAI,E,gDAGZA,mBAAA,CAIM;IAJDW,EAAE,EAAC,aAAa;IAChB,gBAAc,EAAC,0EAA0E;IACzF,eAAa,EAAC,gCAAgC;IAC9C,kBAAgB,EAAC;yDAEtBX,mBAAA,CAOM;IAPDH,KAAK,EAAC,aAAa;IACnB,WAAS,EAAC,UAAU;IACpB,WAAS,EAAC,OAAO;IACjB,YAAU,EAAC,SAAS;IACpB,WAAS,EAAC,cAAc;IACxB,YAAU,EAAC,aAAa;IACxB,qBAAmB,EAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}