{"ast":null,"code":"// src/store/modules/auth.js\nimport ApiService from '@/services/ApiService';\n\n// ### PERBAIKAN DI SINI ###\n// Cek dulu apakah item 'user' ada sebelum di-parse\nconst userItem = localStorage.getItem('user');\nconst user = userItem ? JSON.parse(userItem) : null;\nconst token = localStorage.getItem('token');\nconst state = {\n  user: user,\n  token: token,\n  status: 'idle' // idle, loading, success, error\n};\nconst getters = {\n  isLoggedIn: state => !!state.token,\n  isAdmin: state => state.user && state.user.role === 'admin',\n  authStatus: state => state.status,\n  currentUser: state => state.user\n};\nconst actions = {\n  async register({\n    commit\n  }, userData) {\n    commit('SET_STATUS', 'loading');\n    try {\n      const response = await ApiService.register(userData);\n      const {\n        id,\n        name,\n        email,\n        role,\n        token\n      } = response.data;\n      const userPayload = {\n        id,\n        name,\n        email,\n        role\n      };\n      localStorage.setItem('user', JSON.stringify(userPayload));\n      localStorage.setItem('token', token);\n      commit('AUTH_SUCCESS', {\n        user: userPayload,\n        token\n      });\n      return response;\n    } catch (error) {\n      commit('AUTH_ERROR');\n      localStorage.removeItem('user');\n      localStorage.removeItem('token');\n      throw error;\n    }\n  },\n  async login({\n    commit\n  }, userData) {\n    commit('SET_STATUS', 'loading');\n    try {\n      const response = await ApiService.login(userData);\n      const {\n        id,\n        name,\n        email,\n        role,\n        token\n      } = response.data;\n      const userPayload = {\n        id,\n        name,\n        email,\n        role\n      };\n      localStorage.setItem('user', JSON.stringify(userPayload));\n      localStorage.setItem('token', token);\n      commit('AUTH_SUCCESS', {\n        user: userPayload,\n        token\n      });\n      return response;\n    } catch (error) {\n      commit('AUTH_ERROR');\n      localStorage.removeItem('user');\n      localStorage.removeItem('token');\n      throw error;\n    }\n  },\n  logout({\n    commit\n  }) {\n    commit('LOGOUT');\n    localStorage.removeItem('user');\n    localStorage.removeItem('token');\n  }\n};\nconst mutations = {\n  SET_STATUS(state, status) {\n    state.status = status;\n  },\n  AUTH_SUCCESS(state, {\n    user,\n    token\n  }) {\n    state.status = 'success';\n    state.user = user;\n    state.token = token;\n  },\n  AUTH_ERROR(state) {\n    state.status = 'error';\n    state.user = null;\n    state.token = null;\n  },\n  LOGOUT(state) {\n    state.status = 'idle';\n    state.user = null;\n    state.token = null;\n  }\n};\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations\n};","map":{"version":3,"names":["ApiService","userItem","localStorage","getItem","user","JSON","parse","token","state","status","getters","isLoggedIn","isAdmin","role","authStatus","currentUser","actions","register","commit","userData","response","id","name","email","data","userPayload","setItem","stringify","error","removeItem","login","logout","mutations","SET_STATUS","AUTH_SUCCESS","AUTH_ERROR","LOGOUT","namespaced"],"sources":["E:/ibuPintar/frontend/src/store/modules/auth.js"],"sourcesContent":["// src/store/modules/auth.js\r\nimport ApiService from '@/services/ApiService';\r\n\r\n// ### PERBAIKAN DI SINI ###\r\n// Cek dulu apakah item 'user' ada sebelum di-parse\r\nconst userItem = localStorage.getItem('user');\r\nconst user = userItem ? JSON.parse(userItem) : null;\r\nconst token = localStorage.getItem('token');\r\n\r\nconst state = {\r\n  user: user,\r\n  token: token,\r\n  status: 'idle', // idle, loading, success, error\r\n};\r\n\r\nconst getters = {\r\n  isLoggedIn: state => !!state.token,\r\n  isAdmin: state => state.user && state.user.role === 'admin',\r\n  authStatus: state => state.status,\r\n  currentUser: state => state.user,\r\n};\r\n\r\nconst actions = {\r\n  async register({ commit }, userData) {\r\n    commit('SET_STATUS', 'loading');\r\n    try {\r\n      const response = await ApiService.register(userData);\r\n      const { id, name, email, role, token } = response.data;\r\n      const userPayload = { id, name, email, role };\r\n      localStorage.setItem('user', JSON.stringify(userPayload));\r\n      localStorage.setItem('token', token);\r\n      commit('AUTH_SUCCESS', { user: userPayload, token });\r\n      return response;\r\n    } catch (error) {\r\n      commit('AUTH_ERROR');\r\n      localStorage.removeItem('user');\r\n      localStorage.removeItem('token');\r\n      throw error;\r\n    }\r\n  },\r\n  async login({ commit }, userData) {\r\n    commit('SET_STATUS', 'loading');\r\n    try {\r\n      const response = await ApiService.login(userData);\r\n      const { id, name, email, role, token } = response.data;\r\n      const userPayload = { id, name, email, role };\r\n      localStorage.setItem('user', JSON.stringify(userPayload));\r\n      localStorage.setItem('token', token);\r\n      commit('AUTH_SUCCESS', { user: userPayload, token });\r\n      return response;\r\n    } catch (error) {\r\n      commit('AUTH_ERROR');\r\n      localStorage.removeItem('user');\r\n      localStorage.removeItem('token');\r\n      throw error;\r\n    }\r\n  },\r\n  logout({ commit }) {\r\n    commit('LOGOUT');\r\n    localStorage.removeItem('user');\r\n    localStorage.removeItem('token');\r\n  },\r\n};\r\n\r\nconst mutations = {\r\n  SET_STATUS(state, status) {\r\n    state.status = status;\r\n  },\r\n  AUTH_SUCCESS(state, { user, token }) {\r\n    state.status = 'success';\r\n    state.user = user;\r\n    state.token = token;\r\n  },\r\n  AUTH_ERROR(state) {\r\n    state.status = 'error';\r\n    state.user = null;\r\n    state.token = null;\r\n  },\r\n  LOGOUT(state) {\r\n    state.status = 'idle';\r\n    state.user = null;\r\n    state.token = null;\r\n  },\r\n};\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  getters,\r\n  actions,\r\n  mutations,\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}